---
import Layout from "../../../../layouts/Layout.astro";
const id = Astro.params.id;
---
<Layout title="Modificar Sucursal">
    <h1>Modificar Sucursal</h1>
    <p>Id: {id}</p>
    <form>
        <label for="name">Nombre</label>
        <input type="text" id="name" name="name" required>
        <label for="address">Direcci√≥n</label>
        <input type="text" id="address" name="address" required>
        <button>Actualizar</button>
    </form>
</Layout>


<script define:vars={{id}}>
    fetch(`http://localhost/api/branches/${id}`)
        .then(response => response.json())
        .then(data => {
            document.getElementById('name').value = data.name;
            document.getElementById('address').value = data.address;
        });

    document.querySelector('form').addEventListener('submit', (event) => {
        event.preventDefault();
        const name = document.getElementById('name').value;
        const address = document.getElementById('address').value;
        fetch(`http://localhost/api/branches/${id}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ name, address })
        })
            .then(response => {
                if (response.ok) {
                    alert('Sucursal actualizada');
                    window.location.href = '../';
                } else {
                    alert('Error al actualizar la sucursal');
                }
            });
    });

</script>